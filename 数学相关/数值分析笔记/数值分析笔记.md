# 插值法
## 牛顿插值法
$由于拉氏插值多项式在计算中的不方便，我们考虑另一种插值多项式的形式，牛顿多项式$
$我们令其形式为N_{k}(x)=\sum c_{i}\omega_{i}(x),这里\omega_{i}(x)=\Pi_{j=0}^i(x-x_{j}),倘若我们能求得c_{i},便能算出该多项式$

### 均差的引入
$由于过两点(x_{0},f(x_{0}))与(x_{1},f(x_{1}))的直线方程为$
$N_{1}(x)=f(x_{0})+ \frac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}(x-x_{0})$
$倘若我们记f[x_{0},x_{1}]=\frac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}$
则可以将上式表示为$N_{1}(x)=f(x_{0})+ f[x_{0},x_{1}](x-x_{0})$
$(事实上N_{1}(x)就是一阶插值多项式L_{1}(x))$
$下面我们来考虑N_{2}(x),事实上N_{2}(x)=N_{1}(x)+c_{2}\omega_{2}(x)$
$如果我们记f[x_{0},x_{1},x_{2}]=\frac{f[x_{1},x_{2}]-f[x_{0},x_{1}]}{x_{2}-x_{0}},容易验证这恰好是c_{2}$
接下来我们给出均差的定义：
*Define:k阶均差*
$$
\begin{gather}
我们定义f[x_{0},x_{k}]= \frac{f(x_{k}-f_{x_{0}})}{x_{k}-x_{0}}为函数f关于节点x_{0},x_{k}的一阶均差 \\
一般地，我们把f[x_{0},x_{1},\dots,x_{k}]= \frac{f[x_{1},x_{2},\dots,x_{k}]-f[x_{0},x_{1},\dots,x_{k-1}]}{x_{k}-x_{0}} \\
称作f(x)在x_{0},x_{1},\dots,x_{k}上的k阶均差
\end{gather}
$$
性质：
$$\begin{gather}
(1)f[x_{0},x_{1},\dots,x_{k}] = \sum^k_{i=0} \frac{f(x_{i})}{\omega_{k+1}(x_{i})}\\
(2)f[x_{0},x_{1},\dots,x_{k}]= \frac{f[x_{0},\dots,x_{k-2},x_{k}]-f[x_{0},x_{1},\dots,x_{k-1}]}{x_{k}-x_{k-1}}  \\
(3)若f(x)\in C^n[a,b],且x_{i}\in[a,b]两两不同，则f[x_{0},x_{1},\dots,x_{n}]= \frac{1}{n!}f^n(\xi),\xi\in(a,b) \\
性质(1)采用数学归纳法即证，性质(2)注意到对称性调换x_{0}与x_{k-1}即可 \\
性质(3)采用罗尔定理即证
\end{gather}
$$

我们有时可以用均差表来计算牛顿多项式：

| $x_{k}$ | $f(x_{k})$     | 一阶均差                 | 二阶均差                       | 三阶均差                             |
| ------- | -------------- | -------------------- | -------------------------- | -------------------------------- |
| $x_{0}$ | ==$f(x_{0})$== |                      |                            |                                  |
| $x_{1}$ | $f(x_{1})$     | ==$f[x_{0},x_{1}]$== |                            |                                  |
| $x_{2}$ | $f(x_{2})$     | $f[x_{1},x_{2}]$     | ==$f[x_{0},x_{1},x_{2}]$== |                                  |
| $x_{3}$ | $f(x_{3})$     | $f[x_{2},x_{3}]$     | $f[x_{1},x_{2},x_{3}]$     | ==$f[x_{0},x_{1},x_{2},x_{3}]$== |
| $\dots$ |                |                      |                            |                                  |
可以看出来牛顿多项式适合用递归求解，这里作者使用python写了一个计算牛顿多项式的代码
### 牛顿插值公式
$$
\begin{gather}
由均差的定义，我们有： \\
f(x)=f(x_{0})+f[x,x_{0}](x-x_{0}) \\
f[x,x_{0}]=f[x_{0},x_{1}]+f[x,x_{0},x_{1}](x-x_{1}) \\
\dots\dots\dots \\
f[x,x_{0},x_{1},\dots,x_{n}]=f[x_{0},x_{1},\dots,x_{n}]+f[x,x_{0},\dots,x_{n}](x-x_{n}) \\
依次把后式代回前式得到： \\
f(x)=\sum_{i=0}^nf[x_{0},x_{1},\dots,x_{i}]\omega_{i}(x)\,\,+f[x,x_{0},x_{1},\dots,x_{n}]\omega_{n}(x) =N_{n}(x)+R_{n}(x)\\
称f[x,x_{0},x_{1},\dots,x_{n}]\omega_{n}(x)为牛顿多项式的余项，事实上这正是拉氏多项式的余项
\end{gather}
$$


## 分段低次插值
在机械学习的经验告诉我们，使用太高次的多项式拟合函数会发生过拟合(Runge现象)
为了解决这一问题，我们可以考虑用分段线性插值，即通过相邻两个插值点做线性插值
$I_{n}(x)为分段线性插值函数，若I_{n}在每个小区间上都为线性多项式，且连续且在每个点的函数值都能拟合$
分段线性插值的误差为:
$R_{n}(x)=|f(x)-I_{n}(x)|=\frac{||T||}{8}max_{x\in[a,b]}|f^{''}(x)|$

## 三次样条插值函数
若函数$S(x)满足条件：$
1. $S(x)\in C^2[a,b]$
2. $S(x_{k})=f_{k}$
3. $在每个小区间[x_{k},x_{k+1}]上，S(x)是三次多项式$
则我们$称S(x)为f(x)在[a,b]上的三次样条插值函数$


# 函数逼近与数据拟合

## 连续函数的最佳逼近
在连续函数空间$C[a,b]$上定义内积之后就形成了一个内积空间，类比$\mathbf{R}^{n}$中的基向量，对于内积空间中的元素$f(x)\in C[a,b]$,我们也可以用基函数近似表示:

- 线性无关的函数组：
设$\phi_{0}(x),\phi_{1}(x),\dots \phi_{n}(x)\in C[a,b]$
若$a_{o}\phi_{0}(x)+a_{1}\phi_{1}(x)+\dots+a_{n}\phi_{n}(x)=0,当且仅当a_{0}=a_{1}=\dots=a_{n}时成立$>那么我们称这一组函数是线性无关的，由线性代数的知识，这等价于矩阵
$$
G_{n}=\begin{pmatrix}
(\phi_{0},\phi_{0}) & (\phi_{1},\phi_{0}) & \dots & (\phi_{n},\phi_{0}) \\
(\phi_{0},\phi_{1}) & (\phi_{1},\phi_{1}) & \dots & (\phi_{n},\phi_{1}) \\
\vdots & \vdots &  & \vdots \\
(\phi_{0},\phi_{n}) & (\phi_{1},\phi_{n}) & \dots & (\phi_{n},\phi_{n})
\end{pmatrix}
$$
的行列式det$G_{n} \neq 0$

### 连续函数的最佳平方逼近：
本小节内容可以对照有关傅里叶级数的平方收敛来进行思考
设$\Phi=span\{\phi_{0},\phi_{1},\dots \phi_{n}\},那么对于某个f\in C[a,b]$
我们希望存在$\phi^{*}(x)\in \Phi,使得||f-\phi^{*}||^{2}=inf_{\phi\in \Phi}||f-\phi||=inf_{\phi\in \Phi}\int_{a}^{b} [f(x)-\phi(x)]^{2} \, dx$
$那么我们称\phi^{*}是f在\Phi中的最佳平方逼近函数$
$事实上根据线性代数的知识，我们只要使得(\phi^{*}-f,\phi_{i})=0,那么对于任意的\phi\in \Phi$
我们有:$||f-\phi||^{2}=||f-\phi^{*}+\phi^{*}-\phi||^{2}=||f-\phi^{*}||^{2}+||\phi^{*}-\phi||^{2}\geq||f-\phi^{*}||^{2}$这里用到了勾股定理